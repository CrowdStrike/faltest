language: node_js
node_js:
- '8'
branches:
  only:
  - master
  # npm version tags
  - /^(?:[a-z-]+|@[a-z-]+\/[a-z-]+)@\d+\.\d+\.\d+$/
addons:
  chrome: stable
  firefox: latest
jobs:
  include:
  - name: Lint
    script:
    - yarn lint:git
    - yarn lint:md
    - yarn lint:js
  - name: Test
    env:
    - DEBUG=@faltest*,faltest-helpers WEBDRIVER_HEADLESS=true
  - name: Acceptance
    services:
    - xvfb
    env:
    - DEBUG=@faltest*,faltest-helpers
    script:
    - yarn test:acceptance
  - name: Acceptance
    os: osx
    env:
    - DEBUG=@faltest*,faltest-helpers
    script:
    - yarn test:acceptance
  - name: Global Install Test
    env:
    - DEBUG=@faltest*
    cache:
      npm: false
    install:
    - pushd fixtures/global-install
    - yarn install --production
    - yarn link
    - popd
    script:
    - my-cli --headless
